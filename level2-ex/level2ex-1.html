<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
</head>
<style>
    body {
        font-family: "Courier New", Courier, monospace
    }

    h1,
    p {
        text-align: center;
        font-size: 3em;
        margin: 5px;
    }

    #grid {
        margin: 50px;
        font-size: 2em;
        text-align: center;
        display: grid;
        grid-template-columns: 1fr 1fr;
    }

    p2 {
        font-weight: bold;
    }
</style>

<body>
    <h1>숫자 야구 게임</h1>
    <p>임의의 숫자(1~9사이) 3자리를 맞추는 게임입니다
        <br>
    </p>
    <center>
        <input type="text" placeholder="3자리 숫자 입력" id='usernum1'>
        <input type="button" value="확인" onclick='run()'>
        <br>
    </center>
    <div id="grid">
        <p2>결과창</p2>
        <p2>컴퓨터가 고른숫자는 무슨 숫자일까요?</p2>
        <p2 id='history'>&nbsp;</p2>
        <p2 id="result">? ? ?</p2>
    </div>
    <script>

        var list = [1, 2, 3, 4, 5, 6, 7, 8, 9];
        var aiNumber = [];
        var usernum = [];

        for (var i = 0; i < 3; i++) {
            var select = Math.floor(Math.random() * (list.length));
            aiNumber[i] = list.splice(select, 1)[0];
        }
        console.log(aiNumber);
        function run() {
            usernum = document.getElementById('usernum1').value;
            check();
            var Str = 0;
            var Bal = 0;
            Str = strike(Str);
            Bal = ball();
            // console.log(Str);
            // console.log(Bal);
            // console.log(usernum);
            Baseball(Str, Bal);
        }
        function check() {
            if (usernum.length < 3 || usernum.length > 3) {
                alert('3자리 숫자만 입력해주세요');
                document.getElementById('usernum1').value = ''
                usernum = [];
            }
            for (i = 0; i < usernum.length; i++) {
                if (usernum[i] === usernum[i + 1] || usernum[i] === usernum[i +2]) {
                    alert('중복된 숫자는 입력하실수 없습니다.')
                    document.getElementById('usernum1').value = ''
                    usernum = [];
                }
            }
        }
        function Baseball(Str, Bal) {
            if (Str === 3) {
                alert('3스트라이크! 맞추셨습니다!');
                document.getElementById("result").innerHTML = aiNumber;
                
            } else {
                var his = Str + '스트라이크, ' + Bal + '볼' + '<br>';
                document.getElementById("history").innerHTML = his;
            }
        }
        function strike(Str) {
            for (var i = 0; i < 3; i++) {
                if (usernum[i] == aiNumber[i]) {
                    Str++
                }
            }
            return Str;
        }
        // function ball() {
        //     Bal = 0;
        //     for (var n = 0; n < 3; n++) {
        //         for (var m = 0; m < 3; m++) {
        //             if ((m != n) && (usernum[m] == aiNumber[n])) {
        //                 Bal++;
        //             }
        //         }
        //     }
        //     return Bal;
        // }

        // function ball() {
        //     bal = 0;
        //     var j = 0;
        //     if (j === 2) {
        //         return bal;
        //     } else {
        //         for (i = 0; i < aiNumber.length; i++) {
        //             if ((j != i) && usernum[j] == aiNumber[i]) {
        //                 bal++
        //             }
        //         }
        //         j++
        //         ball();
        //     }
        // }
        function ball() {
            Bal = 0;
            var j = 0;
            for( j=0; j<3; j++){
                ballloop(j)
            }
            return Bal;
        }
        function ballloop(j){
            for (i = 0; i < aiNumber.length; i++) {
                if ((j != i) && usernum[j] == aiNumber[i]) {
                    Bal++;
                }
            }
        }
    </script>
</body>

</html>